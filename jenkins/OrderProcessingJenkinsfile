pipeline {
	agent none

	environment {
		DOCKER_HOST_IP = '192.168.1.121'
		NETWORK = 'order-processing-net'
		registryCredential = 'dockerhub'
	    }
stages {
	stage('Buinding application') {
		agent{
			docker {
			    image 'maven:3-alpine'
			    args '-v $HOME/.m2:/root/.m2'
			}
		}
		steps {
			sh 'mvn clean install'
		}
	}
	stage('Building Image') {
		agent any
		steps {
			sh 'docker build -f customer-service/Dockerfile customer-service/ -t carloselpapa10/customer-service' + ":$BUILD_NUMBER"
		}
	}
  }
}

